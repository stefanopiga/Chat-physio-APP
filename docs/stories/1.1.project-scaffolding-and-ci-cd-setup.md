
# Story 1.1: Project Scaffolding & CI/CD Setup

**Status:** Done

## Story

**As a** Sviluppatore,
**I want** un Monorepo con frontend e backend inizializzati, configurazione Docker per lo sviluppo locale e una pipeline di CI di base,
**so that** possiamo avere un ambiente di sviluppo e integrazione consistente e automatizzato fin dal primo giorno.

## Acceptance Criteria

1.  Il Monorepo è creato con le directory `frontend` e `backend`.
2.  Un file `docker-compose.yml` avvia correttamente i servizi di frontend e backend per lo sviluppo locale.
3.  Una pipeline di CI (es. GitHub Actions) si avvia ad ogni push, installa le dipendenze ed esegue i linter per entrambi i progetti.
4.  L'app React mostra una pagina placeholder.
5.  Il backend FastAPI espone un endpoint di health-check.

## Dev Notes

### Previous Story Insights
*   Questa è la prima storia di implementazione tecnica; non ci sono insight da storie precedenti.

### Data Models
*   Questa storia non interagisce direttamente con i modelli di dati.

### API Specifications
*   **Backend**: Deve essere esposto un endpoint `GET /health` che restituisca una risposta JSON: `{"status": "ok"}`. Non è richiesta autenticazione per questo endpoint. [Fonte: `prd.md#Story 1.1`]

### Component Specifications
*   **Frontend**: Creare un componente `App.tsx` placeholder che renderizzi un semplice `<h1>` con il testo "Frontend Placeholder". Non sono richiesti stili o logica complessa. [Fonte: `prd.md#Story 1.1`]

### File Locations
*   **Monorepo Root**: `/`
*   **Frontend App**: `/apps/web/`
*   **Backend App**: `/apps/api/`
*   **Shared Packages**: `/packages/`
*   **Docker Compose File**: `/docker-compose.yml`
*   **GitHub Actions Workflow**: `/.github/workflows/ci.yml`
    [Fonte: `architecture/sezione-7-struttura-unificata-del-progetto.md`]

### Testing
*   I test unitari non sono un requisito per questa storia di scaffolding. Tuttavia, la pipeline di CI deve includere uno step per eseguire i linter (`ESLint` per il frontend, `Ruff` per il backend) per validare la qualità del codice. [Fonte: `architecture/sezione-11-strategia-di-testing.md`, `architecture/sezione-12-standard-di-codifica.md`]

### Technical Constraints
*   **Monorepo Tool**: `pnpm workspaces`. [Fonte: `architecture/sezione-2-architettura-di-alto-livello.md`]
*   **Frontend Build Tool**: `Vite` con `TypeScript`. [Fonte: `architecture/sezione-3-tech-stack.md`]
*   **Backend Framework**: `FastAPI` con `Poetry`. [Fonte: `architecture/sezione-3-tech-stack.md`]
*   **Containerization**: `Docker` e `Docker Compose`. [Fonte: `architecture/sezione-9-architettura-di-deployment.md`]
*   **CI/CD**: `GitHub Actions`. [Fonte: `architecture/sezione-9-architettura-di-deployment.md`]

## Tasks / Subtasks

- [ ] **Setup Monorepo e Struttura Progetto (AC: 1)**
    - [ ] Inizializza un nuovo repository Git.
    - [ ] Crea la struttura di directory di base come definito in `architecture/sezione-7-struttura-unificata-del-progetto.md`, includendo `apps/web`, `apps/api`, e `packages/shared-types`.
    - [ ] Inizializza `pnpm` come gestore di workspace (`pnpm-workspace.yaml`).
    - [ ] Creare un file `.nvmrc` alla root del progetto specificando la versione di Node.js (es. 20.11.0).
- [ ] **Inizializzazione Progetto Frontend (AC: 4)**
    - [ ] Nella directory `apps/web`, crea una nuova applicazione React usando Vite con il template TypeScript.
    - [ ] Installa le dipendenze di base: `react`, `react-dom`, `typescript`.
    - [ ] Crea un componente `App.tsx` placeholder che mostri un messaggio semplice (es. "Frontend Placeholder").
- [ ] **Inizializzazione Progetto Backend (AC: 5)**
    - [ ] Nella directory `apps/api`, inizializza un nuovo progetto Python con `Poetry`.
    - [ ] Installa le dipendenze di base: `fastapi`, `uvicorn`.
    - [ ] Crea un file `main.py` che esponga un endpoint di health-check `GET /health` che ritorni `{"status": "ok"}`.
- [ ] **Configurazione Ambiente di Sviluppo Docker (AC: 2)**
    - [ ] Crea un `Dockerfile` per il servizio `web` che installi le dipendenze e avvii il dev server di Vite.
    - [ ] Crea un `Dockerfile` per il servizio `api` che installi le dipendenze e avvii il server Uvicorn.
    - [ ] Crea un file `docker-compose.yml` alla root del progetto che definisca i servizi `web` e `api`, mappando le porte e i volumi per l'hot-reloading, **assicurandosi di legare le porte a 127.0.0.1 (es. "127.0.0.1:5173:5173") per evitare l'esposizione sulla rete pubblica.**
- [ ] **Setup Pipeline di CI di Base (AC: 3)**
    - [ ] Crea una directory `.github/workflows`.
    - [ ] Crea un file `ci.yml` che definisca un workflow di GitHub Actions.
    - [ ] Il workflow deve:
        - [ ] Attivarsi ad ogni `push` sui branch `main` e `develop`.
        - [ ] Eseguire il checkout del codice.
        - [ ] Impostare Node.js e Python.
        - [ ] Eseguire `pnpm install` per il frontend e `poetry install` per il backend.
        - [ ] Eseguire i linter per entrambi i progetti (es. `pnpm lint`, `poetry run ruff check`).

## Change Log

| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
|      | 1.0     | Initial draft | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
{{agent_model_name_version}}

### Debug Log References

### Completion Notes List

### File List

## QA Results

### Review Date: 2025-09-10

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

As this is a scaffolding story, no application code was reviewed. The review focused on the completeness and quality of the plan outlined in the story. The plan is thorough, well-defined, and incorporates best practices for environment setup and CI/CD.

### Refactoring Performed

- **File**: `docs/stories/1.1.project-scaffolding-and-ci-cd-setup.md`
  - **Change**: Added two subtasks to mitigate risks identified in the risk profile.
  - **Why**: To ensure environment consistency (TECH-001) and prevent accidental exposure of services (SEC-001).
  - **How**: Added a task to create a `.nvmrc` file and updated the `docker-compose.yml` task to require binding ports to `127.0.0.1`.

### Compliance Check

- Coding Standards: [✓] (Not applicable, but linter setup is included)
- Project Structure: [✓] (Clearly defined in the story)
- Testing Strategy: [✓] (Linter checks are appropriately included for this stage)
- All ACs Met: [✓] (The plan covers all acceptance criteria)

### Improvements Checklist

- [x] Added task to create `.nvmrc` file for Node.js version consistency.
- [x] Updated `docker-compose.yml` task to include security best practice for port binding.

### Gate Status

Gate: **PASS** → `docs/qa/gates/1.1-project-scaffolding-and-ci-cd-setup.yml`
Risk profile: `docs/qa/assessments/1.1-project-scaffolding-and-ci-cd-setup-risk-20250910.md`

### Recommended Status

[✓ Ready for Approved]
(The story is currently in "Draft" and should be moved to "Approved" to begin development.)
