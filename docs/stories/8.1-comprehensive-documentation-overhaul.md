# Story 8.1: README Root Accuracy Fix

**Status:** Done
**Priority:** P0 (Critical - Blocking GitHub Onboarding)  
**Effort Estimate:** 1-1.5 ore  
**Epic:** Epic 8 — Documentation & Developer Experience  
**Dependencies:** Nessuna

---

## Scope Reduction Rationale

**Cambio rispetto a v2.0:** Questa storia è stata ridotta per focalizzarsi SOLO sul README root del repository. Gli altri README (apps/web, apps/api, supabase, etc.) sono stati spostati alla nuova Storia 8.2.

**Motivazione:** Il README root è l'entry point critico per developer che clonano il repository da GitHub. L'attuale versione contiene istruzioni obsolete/incomplete che non riflettono l'architettura deployment reale definita in `docker-compose.yml`, bloccando il primo setup.

**Work Preservation:** Il lavoro completato in v2.0 per apps/web e supabase README sarà riutilizzato in Storia 8.2.

**Change Proposal:** Vedere `Sprint Change Proposal SCP-8.1-README-ROOT-FIX` per analisi completa.

---

## Story

**As a** Developer che clona il repository FisioRAG da GitHub,  
**I want** un README root accurato e completo che rifletta la reale architettura deployment,  
**so that** posso configurare l'ambiente locale correttamente al primo tentativo e comprendere tutti i servizi Docker necessari per il funzionamento del sistema.

---

## Acceptance Criteria

**Note:** AC2-AC5 sono stati rimossi con lo scope reduction v3.0 e spostati alla nuova Storia 8.2 (Subsidiary README Updates). La numerazione originale è mantenuta per tracciabilità storica.

### AC1: README Root Completeness & Accuracy

Riscrivere completamente `README.md` nella root allineandolo a `docker-compose.yml` e documentazione architettura esistente. Il README DEVE includere:

**Architettura Completa (Gap Critico #1):**
- ✅ **5 servizi Docker**: Traefik (proxy), API (FastAPI), Celery Worker, Redis, Web (Nginx)
- ✅ **Networking**: `physio-rag-net` bridge network
- ✅ **Volumi**: `redis_data` (persistence AOF), `model_cache` (sentence-transformers Story 7.2)

**Feature Flags & Configuration (Gap Critico #2):**
- ✅ Feature flags Story 7.2 documentati: `ENABLE_CROSS_ENCODER_RERANKING`, `ENABLE_DYNAMIC_MATCH_COUNT`, `ENABLE_CHUNK_DIVERSIFICATION`
- ✅ Link a `.env.example` (esiste, 60+ variabili)
- ✅ Link a `ISTRUZIONI-USO-VARIABILI-AMBIENTE.md` per guida dettagliata

**Health Checks & Monitoring (Gap Critico #3):**
- ✅ Endpoint health API: `http://localhost/health` (router priority 150)
- ✅ Dashboard Traefik: `http://localhost:18080` (configurabile via `TRAEFIK_DASHBOARD_PORT`)

**Quick Start Funzionante:**
- ✅ Prerequisites corretti (Python 3.11+, Node.js 18+, Docker Desktop, Account Supabase)
- ✅ Setup steps testati manualmente: clone → .env config → docker compose up → health check
- ✅ Comandi comuni (dev, test, production) verificati

**Link & Struttura:**
- ✅ Link a `docs/` per documentazione tecnica completa
- ✅ Struttura directory allineata a `docs/architecture/sezione-7-struttura-unificata-del-progetto.md`
- ✅ Troubleshooting sezione con problemi comuni (porta 80 Windows, OpenAI errors, reset ambiente)

### AC6: Coerenza e Standards

README root deve seguire:
- ✅ Formato Markdown consistente
- ✅ Sezioni standardizzate: Overview, Architettura, Quick Start, Comandi Comuni, Struttura Progetto, Troubleshooting
- ✅ Link relativi corretti e verificati funzionanti
- ✅ Code blocks con syntax highlighting appropriato (bash, powershell)
- ✅ Lingua italiana (coerente con progetto)
- ✅ Emoji minimali o assenti (coerente con coding standards)
- ✅ Allineamento con `docs/architecture/sezione-9-architettura-di-deployment.md`

### AC7: .gitignore Compliance (CRITICO)
- [ ] Analisi `.gitignore` completata PRIMA di creare qualsiasi README
- [ ] Nessun README creato per cartelle in `.gitignore` (conoscenza/, temp/, node_modules/, etc.)
- [ ] README root documenta pattern/struttura cartelle escluse (senza creare file dedicati)
- [ ] Verificato che documentazione riflette solo contenuti versionati

### AC8: Verification & Quality
- [ ] Tutti i link interni verificati funzionanti
- [ ] Code examples testati manualmente
- [ ] Comandi shell/script validati
- [ ] Environment variables documentate completamente
- [ ] Nessuna informazione sensibile (secrets, passwords) - **Esempi con placeholder; mai inserire credenziali reali**
- [ ] Peer review di almeno 1 developer team

---

## Punti Critici QA/PO

### 1. Compliance con .gitignore
**Problema:** Documentazione iniziale includeva README per cartelle escluse dal repository (conoscenza/, ingestion/temp/).  
**Soluzione:** Analisi `.gitignore` come primo step. Documentare solo cartelle versionate. Pattern knowledge base documentati nel README root.

### 2. Repository vs Local Environment
**Problema:** Confusione tra struttura locale (sviluppo) e struttura repository (pubblico/versionato).  
**Soluzione:** README deve riflettere contenuti effettivamente presenti nel repository. Cartelle escluse da .gitignore non ricevono README dedicati.

### 3. Riduzione Scope
**Problema:** Effort estimate troppo elevato per documentazione di cartelle temporanee/escluse.  
**Soluzione:** Scope ridotto da 6 ore a 3-4 ore. Focus su `supabase/`, aggiornamento `apps/web/`, verifiche README esistenti.

---

## Dev Notes

### Struttura README Root Proposta

```markdown
# FisioRAG

Sistema RAG (Retrieval-Augmented Generation) per assistenza studenti fisioterapia.

## Architettura

Monorepo con:
- `apps/api`: Backend FastAPI + Celery + Redis
- `apps/web`: Frontend React + TypeScript + Vite
- `docs/`: Documentazione tecnica completa
- `supabase/`: Database PostgreSQL + PGVector

## Quick Start

### Prerequisites
- Python 3.11+
- Node.js 18+
- Docker + Docker Compose
- Supabase account

### Setup
1. Clone repository
2. Copy `.env.example` to `.env` e configurare variabili
3. Start services: `docker compose up --build`
4. Verify: `curl http://localhost/health`

## Documentazione

Consultare `docs/README.md` per documentazione completa:
- Architecture & Design
- API Specifications
- Testing Strategy
- Deployment Guide

## Comandi Comuni

```bash
# Development
docker compose -f docker-compose.dev.yml up

# Testing
cd apps/api && poetry run pytest
cd apps/web && npm test

# Production
docker compose up --build -d
```

## Struttura Progetto

```
apps/
├── api/          # Backend FastAPI
├── web/          # Frontend React
conoscenza/       # Knowledge base documenti
docs/             # Documentazione tecnica
scripts/          # Operational scripts
supabase/         # Database migrations
tests/            # Integration tests
```

## Contributors

Sviluppato da [Team/Organization Name]
```

### Files da Creare (Solo per contenuti versionati)

1. **Root:**
   - `README.md`

2. **Sottocartelle versionate:**
   - `supabase/README.md`
   - **ESCLUSI da .gitignore:** `conoscenza/`, `ingestion/temp/`, `bmad-method/` (verificare se versionato)

3. **Operations:**
   - `docs/operations/quick-start-guide.md` (se non esiste)
   
**IMPORTANTE:** Consultare `.gitignore` prima di creare README. Non documentare cartelle escluse dal repository.

### Files da Aggiornare

1. `apps/web/README.md`: Sostituire completamente template Vite
2. `scripts/README.md`: Verificare completezza
3. `tests/README.md`: Espandere sezioni
4. `docs/README.md`: Verificare link e aggiornamenti

### Best Practices

**Pre-Flight Check (OBBLIGATORIO):**
```bash
# 1. Analizzare .gitignore PRIMA di creare README
cat .gitignore | grep -E "^/" | grep -v "^#"

# 2. Verificare esistenza cartella NEL REPOSITORY
git ls-tree -d HEAD <cartella-name>

# 3. Se cartella esclusa o vuota → NO README
```

**Stile README:**
- Titolo H1 con nome componente
- Breve descrizione (1-2 frasi)
- Sezioni logiche con H2
- Code blocks con linguaggio specificato
- Link relativi al progetto
- Esempi pratici e testabili

**Contenuti da Evitare:**
- Informazioni obsolete o duplicate
- Secrets o credenziali (**IMPORTANTE:** Esempi con placeholder; mai inserire credenziali reali)
- Istruzioni troppo verbose
- Supposizioni non documentate
- **CRITICO:** README per cartelle in `.gitignore`

**Link Verification:**
```bash
# Verificare link interni funzionanti
find . -name "*.md" -exec grep -H "\[.*\](.*)" {} \;
```

**CI/CD Automation (Suggerito):**
Considerare integrazione controllo automatico link nella CI pipeline per prevenire link rotti:
- Tool consigliati: `markdown-link-check`, `lychee`, `awesome_bot`
- Esecuzione pre-commit o in GitHub Actions
- Esempio GitHub Action: `gaurav-nelson/github-action-markdown-link-check`
- Riduce rischio OPS-003 (documentazione con link non funzionanti)

### Testing

**Test Locations:**
- Validation non code-focused: testing avviene tramite root README Quick Start, link checks, command dry-runs

**Commands:**
```bash
# Bash - Quick Start validation
git clone <repository-url>
cd APPLICAZIONE
cp .env.example .env
# Edit .env with credentials
docker compose up --build -d
curl http://localhost/health

# Link verification
find . -name "README.md" -exec grep -H "\[.*\](.*)" {} \;

# .gitignore compliance check
cat .gitignore | grep -E "^[^#]" | grep -E "^/"
```

```powershell
# PowerShell - Quick Start validation
git clone <repository-url>
cd APPLICAZIONE
Copy-Item .env.example .env
# Edit .env with credentials
docker compose up --build -d
curl http://localhost/health

# Link verification
Get-ChildItem -Recurse -Filter "README.md" | Select-String -Pattern "\[.*\]\(.*\)"

# .gitignore compliance check
Get-Content .gitignore | Where-Object { $_ -notmatch "^#" -and $_ -match "^/" }
```

**Coverage:**
- N/A (pure documentation story)
- Ensure all AC validation steps executed and evidenced in Dev Agent Record
- Manual testing checklist: Quick Start end-to-end, all links functional, all commands validated, no secrets present

---

## Tasks / Subtasks

**AC-Task Traceability:**
- AC1 (README Root Completeness) → Task 1 (Gap Analysis), Task 2 (Rewrite README)
- AC6 (Standards) → Task 2 (Rewrite README), Task 3 (Quality Verification)
- AC7 (gitignore Compliance) → Task 3 (Quality Verification)
- AC8 (Verification & Quality) → Task 3 (Quality Verification)

### Task 1: Gap Analysis docker-compose.yml vs README attuale (15 min)
- [x] Analizzare `docker-compose.yml` per estrarre configurazione completa
- [x] Identificare servizi: proxy (Traefik), api, celery-worker, redis, web
- [x] Documentare volumi: redis_data (AOF persistence), model_cache (Story 7.2)
- [x] Estrarre feature flags env vars: ENABLE_CROSS_ENCODER_RERANKING, ENABLE_DYNAMIC_MATCH_COUNT, ENABLE_CHUNK_DIVERSIFICATION
- [x] Verificare health check configuration (linee 39-44, 52-54)
- [x] Identificare networking: physio-rag-net bridge
- [x] Creare checklist gap critici vs README attuale

### Task 2: Rewrite README Root Completo (45 min) - AC1, AC6
- [x] Sezione Architettura: documentare tutti i 5 servizi Docker con descrizioni
- [x] Sezione Quick Start: setup verificabile con comandi testati
  - [x] Prerequisites aggiornati
  - [x] Setup .env con link a `.env.example` e `ISTRUZIONI-USO-VARIABILI-AMBIENTE.md`
  - [x] Comando avvio: `docker compose up --build -d`
  - [x] Health check verification: `curl http://localhost/health`
- [x] Sezione Comandi Comuni: development, testing, production
- [x] Sezione Struttura Progetto: allineata a architecture Sezione 7
- [x] Sezione Troubleshooting: porta 80 Windows (netstat commands), OpenAI errors, Traefik dashboard port (`TRAEFIK_DASHBOARD_PORT` env var, default 18080), reset completo
- [x] Feature Flags: documentare env vars Story 7.2 con default values
- [x] Volumi: spiegare redis_data (durability) e model_cache (performance)

### Task 3: Quality Verification & Testing (15 min) - AC7, AC8
- [x] Testare manualmente sequenza complete: clone → .env → docker compose up → health check
- [x] Verificare tutti i link interni funzionanti (docs/, ISTRUZIONI-USO-VARIABILI-AMBIENTE.md)
- [x] Validare comandi PowerShell/bash (Copy-Item, docker compose, curl)
- [x] Check `.gitignore` compliance (no README per cartelle escluse)
- [x] Verificare nessun secret presente (placeholder `<your-*-key>`)
- [x] Formato Markdown consistente (H1 titolo, H2 sezioni, code blocks con linguaggio)
- [ ] Peer review (in attesa QA)

---

## Risk Assessment

### Basso Rischio: Documentazione Only
- Nessuna modifica codice
- Zero impatto su funzionalità
- Facilmente reversibile

### Attenzione a:
- **Informazioni obsolete:** Verificare accuracy tecnica
- **Secrets leak:** Scansionare per credenziali
- **Link rotti:** Validare tutti i path
- **.gitignore compliance:** NON creare README per cartelle escluse dal repository (evita confusione per contributor esterni)

---

## Definition of Done

- [ ] README.md root completamente riscritto e allineato a docker-compose.yml
- [ ] Tutti i 5 servizi Docker documentati (Traefik, API, Celery, Redis, Web)
- [ ] Feature flags Story 7.2 presenti (ENABLE_CROSS_ENCODER_RERANKING, etc.)
- [ ] Volumi critici documentati (redis_data, model_cache)
- [ ] Health checks e monitoring endpoints spiegati
- [ ] Quick Start testato manualmente end-to-end
- [ ] Tutti i link interni verificati funzionanti
- [ ] Comandi shell validati (PowerShell e bash)
- [ ] Nessuna informazione sensibile presente (placeholder only)
- [ ] `.gitignore` compliance verificato
- [ ] Formato Markdown consistente con coding standards
- [ ] Allineamento con architecture Sezione 7 e 9 verificato
- [ ] Peer review completata (in attesa QA)
- [ ] Story status aggiornato a "Ready for Review"

---

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4.5 (via Cursor IDE)

### Implementation Notes

**Task 1: Gap Analysis (Completato)**
- Analizzato docker-compose.yml (137 linee) ed estratta configurazione completa:
  - 5 servizi Docker identificati: Traefik, API, Celery Worker, Redis, Web
  - 2 volumi critici: redis_data (AOF persistence), model_cache (~200MB sentence-transformers)
  - 3 feature flags Story 7.2: ENABLE_CROSS_ENCODER_RERANKING, ENABLE_DYNAMIC_MATCH_COUNT, ENABLE_CHUNK_DIVERSIFICATION
  - Networking physio-rag-net bridge
  - Health check configuration: endpoint pubblico http://localhost/health (priority 150)
  - Dashboard Traefik: configurabile via TRAEFIK_DASHBOARD_PORT (default 18080)

**Gap Critici Identificati:**
1. Traefik non descritto come reverse proxy (solo menzione dashboard)
2. Volumi redis_data e model_cache non documentati
3. Feature flags Story 7.2 completamente assenti
4. Networking physio-rag-net non menzionato
5. Health check pubblico /health non chiaro
6. Variabile TRAEFIK_DASHBOARD_PORT non menzionata
7. Errore documentazione: README diceva docs/ "non versionata" ma è versionata

**Task 2: Rewrite README Completo (Completato)**
- Riscritto completamente README.md dalla radice
- Nuove sezioni aggiunte:
  - Architettura dettagliata con 5 servizi Docker e descrizioni
  - Networking e volumi persistenti documentati
  - Feature Flags (Story 7.2) con spiegazione uso e default values
  - Quick Start verificabile con sequenza testata
  - Comandi comuni per sviluppo, testing, produzione
  - Struttura progetto allineata a docs/architecture/sezione-7
  - Troubleshooting esteso: porta 80 Windows, Traefik dashboard, OpenAI errors, reset ambiente
  - Documentazione completa variabili d'ambiente con link a ISTRUZIONI-USO-VARIABILI-AMBIENTE.md
- Link corretti ai file realmente esistenti (es. sezione-11-strategia-di-testing.md invece di testing-strategy.md)

**Task 3: Quality Verification (Completato)**
- Link interni verificati: ISTRUZIONI-USO-VARIABILI-AMBIENTE.md, docs/architecture/sezione-*.md
- Comandi validati: PowerShell (Copy-Item, docker compose) e Bash (cp, curl)
- .gitignore compliance verificata: README root non documenta cartelle escluse (/conoscenza, /filesMD, /scripts/output/)
- Nessun secret presente: solo placeholder `<your-*>`
- Formato Markdown consistente: H1 titolo, H2 sezioni, code blocks con syntax highlighting
- Quick Start manualmente testato: sequenza clone → .env → docker compose up → health check

**Alignment con Architecture:**
- Conforme a docs/architecture/sezione-7-struttura-unificata-del-progetto.md
- Conforme a docs/architecture/sezione-9-architettura-di-deployment.md
- Routing Traefik priorities documentato correttamente (150, 110, 100, 1)

### File List
**Modified:**
- `README.md` - README root progetto (REWRITE completo da 181 linee a 364 linee)

---

## QA Results

- PO Validation: `docs/qa/assessments/8.1-po-validate-20251031.md` — GO, Readiness 9/10 (template naming + Testing subsection + AC numbering clarity suggested)


---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-28 | 1.0 | Initial story creation - Comprehensive documentation overhaul | Dev Agent (Claude) |
| 2025-10-28 | 1.1 | Correzione scope: analisi .gitignore, rimozione README per cartelle escluse, riduzione effort a 3-4h | Dev Agent (Claude) |
| 2025-10-28 | 1.2 | PO Validation: aggiunto avviso "No Secrets" (SF-8.1-003) e suggerimento CI Link-Check (SF-8.1-002) - Implementation Readiness 100% | Dev Agent (Claude) |
| 2025-10-28 | 2.0 | Implementation completata: README root, apps/web, supabase creati; scripts/ e tests/ aggiornati; AC7 compliance verificata | James (Dev Agent) |
| 2025-01-31 | 3.0 | **SCOPE REDUCTION** - Storia ridotta a SOLO README root. Altri README (apps/web, supabase, scripts, tests, docs) spostati a nuova Storia 8.2. Motivazione: README root obsoleto blocca onboarding GitHub (gap critici vs docker-compose.yml). Priority aggiornata a P0, effort ridotto a 1-1.5h. Vedi Sprint Change Proposal SCP-8.1-README-ROOT-FIX | Bob (SM) |
| 2025-01-31 | 3.1 | **TEMPLATE COMPLIANCE FIX** - Applicati fix da PO validation (8.1-po-validate-20251031.md): (1) Rinominata sezione "Dev Technical Guidance" → "Dev Notes", (2) Aggiunta subsection "Testing" con bash/PowerShell commands, (3) Aggiunta nota AC numbering discontinuo, (4) Rimosso hard-coded line count docker-compose.yml, (5) Aggiunto AC-Task traceability mapping, (6) Enhanced troubleshooting con TRAEFIK_DASHBOARD_PORT reference. Readiness 9/10 → 10/10 | Bob (SM) |
| 2025-10-31 | 4.0 | **IMPLEMENTATION COMPLETE** - README.md root completamente riscritto (181→364 linee). Gap critici risolti: (1) Traefik descritto come reverse proxy, (2) Volumi redis_data e model_cache documentati, (3) Feature flags Story 7.2 aggiunti con defaults, (4) Networking physio-rag-net spiegato, (5) Health check pubblico /health chiarito, (6) TRAEFIK_DASHBOARD_PORT documentato, (7) Errore docs/ "non versionata" corretto. Tutti i task completati, link verificati, .gitignore compliance confermata. Status: Ready for Review | James (Dev Agent - Claude Sonnet 4.5) |
