# Risk Profile: Story 4.2 ‚Äî Analytics Dashboard

**Date**: 2025-10-02  
**Reviewer**: QA Team  
**Story Type**: Feature / Post-MVP Enhancement  
**Epic**: Epic 4 ‚Äî Post-MVP Enhancements  
**Status**: RISK ASSESSMENT COMPLETE

---

## Executive Summary

**Total Risks Identified**: 5  
**Critical Risks**: 0  
**High Risks**: 2  
**Medium Risks**: 2  
**Low Risks**: 1  
**Overall Risk Score**: **28/60** (MODERATE)

**Assessment Decision**: ‚ö†Ô∏è **APPROVED WITH CONDITIONS**

**Key Risk Areas**:
- **Technical Debt**: R-4.2-1 (High) - Dati volatili in-memory, impatto su analytics storico
- **Security**: R-4.2-2 (High) - Privacy leak session_id, mitigazione obbligatoria
- **Performance**: R-4.2-3 (Medium) - Aggregation lenta su dataset ampio
- **Bundle Size**: R-4.2-4 (Low) - Risolto con Recharts, monitoraggio consigliato
- **Responsive**: R-4.2-5 (Medium) - Layout regression possibile, test E2E richiesti

**Critical Findings**: 0 (nessun blocker assoluto)  
**High Findings**: 2 (richiedono implementazione immediata mitigazioni)  
**Medium Findings**: 2 (monitoring/testing addizionali)  
**Low Findings**: 1 (risolto, solo monitoring)

**Risks Accepted as Technical Debt**: 1 (R-4.2-1)  
**Risks Mitigated**: 3 (R-4.2-2, R-4.2-3, R-4.2-4)  
**Risks Requiring Verification**: 2 (R-4.2-3, R-4.2-5)

---

## Scope & Sources

**Story Document**: `docs/stories/4.2.analytics-dashboard.md`  
**Related Documents**:
- Architecture Security: `docs/architecture/sezione-10-sicurezza-e-performance.md`
- Testing Strategy: `docs/architecture/sezione-11-strategia-di-testing.md`
- PRD Epic 4: `docs/prd/sezione-epic-4-dettagli-post-mvp-enhancements.md`
- Recharts Implementation Guide: `docs/architecture/addendum-recharts-implementation-4.2.md`

**Analysis Date**: 2025-10-02  
**Target Implementation**: Post-MVP Sprint 2

---

## Critical Risks Requiring Immediate Attention

**Nessun rischio critico identificato.**

Tutti i rischi High (R-4.2-1, R-4.2-2) hanno strategie di mitigazione definite e approvate.

---

## High Risks Requiring Mandatory Mitigation

### R-4.2-1: Dati Analytics Volatili (In-Memory)

**Category**: Technical Debt / Data Persistence  
**Probability**: Alta (3/3)  
**Impact**: Alto (3/3)  
**Risk Score**: 9/9  
**Priority**: High

**Description**:
I dati analytics sono aggregati da store in-memory (`chat_messages_store`, `feedback_store`, `ag_latency_samples_ms`) che sono volatili e vengono persi al riavvio del server. Questo limita severamente l'utilit√† della dashboard analytics per:
- Analisi trend storici
- Confronto performance nel tempo
- Identificazione pattern di lungo periodo
- Reportistica per stakeholder

**Impact Analysis**:
- ‚ùå **Business Value**: Dashboard perde valore come strumento di insight didattico se dati sono volatili
- ‚ùå **User Experience**: Admin frustrato da perdita dati dopo deploy/restart
- ‚ö†Ô∏è **Data Integrity**: Aggregazioni accurate solo per sessione server corrente
- ‚úÖ **System Stability**: Nessun impatto (dati in-memory gi√† esistenti)

**Mitigation Strategy** (ACCEPTED AS TECHNICAL DEBT):
- ‚úÖ **Decisione strategica**: Debito tecnico accettato per MVP
- üìã **Backlog Phase 2**: Implementare persistence su Supabase (`analytics_events` table)
- üìä **Trade-off documentato**: Velocit√† implementazione (5-7h) vs completezza funzionale
- üéØ **Success Metric Phase 1**: Dashboard funzionante per monitoring real-time sessione corrente
- üîÑ **Phase 2 Requirements**:
  - Schema Supabase: `analytics_events(session_id, query_text, feedback_vote, timestamp, latency_ms)`
  - Batch insert: aggregazione periodica (ogni 5 min) per ridurre overhead DB
  - Retention policy: 90 giorni storico analytics

**Sources**:
- `docs/stories/4.2.analytics-dashboard.md` L236 (Risk table)
- `docs/stories/4.2.analytics-dashboard.md` L78-81 (Data sources)
- `docs/prd/sezione-epic-4-dettagli-post-mvp-enhancements.md` L68-73 (Phase 2 backlog)

**Verification Requirements**:
- ‚úÖ Documentato nel Change Log della story come debito tecnico accettato
- ‚úÖ Ticket Backlog creato per Phase 2 persistence
- ‚ö†Ô∏è Monitoraggio: feedback admin su utilit√† dashboard con dati volatili

---

### R-4.2-2: Privacy Leak Session ID

**Category**: Security / Privacy  
**Probability**: Bassa (1/3)  
**Impact**: Alto (3/3)  
**Risk Score**: 3/9  
**Priority**: High (per severity impatto)

**Description**:
Il `session_id` √® un identificatore univoco di sessione utente che, se esposto senza hashing, potrebbe essere usato per tracciare pattern di utilizzo individuale, violando principio anonimizzazione analytics e potenzialmente GDPR compliance.

**Threat Scenario**:
1. Admin malintenzionato accede a dashboard analytics
2. Vede `session_id` in chiaro nella response JSON
3. Correla `session_id` con altri log/database per de-anonimizzare utenti
4. Identifica studenti specifici e pattern domande personali

**Impact Analysis**:
- ‚ùå **Privacy Compliance**: Potenziale violazione GDPR (Art. 25 - Privacy by Design)
- ‚ùå **Trust**: Perdita fiducia se studenti scoprono possibilit√† tracking
- ‚ö†Ô∏è **Security**: `session_id` esposto aumenta surface attack per session hijacking
- ‚ùå **Legal**: Liability per data breach se session_id tracciabile

**Mitigation Strategy** (MANDATORY IMPLEMENTATION):
- ‚úÖ **Hash SHA256**: Backend applica hash a `session_id` prima di esporre in response analytics
- ‚úÖ **Implementation**:
  ```python
  import hashlib
  
  def anonymize_session_id(session_id: str) -> str:
      return hashlib.sha256(session_id.encode()).hexdigest()[:16]
  
  # Usage in analytics endpoint
  hashed_session_id = anonymize_session_id(session_id)
  ```
- ‚úÖ **Security Review**: Code review obbligatorio pre-merge per verificare hashing
- ‚úÖ **Test Coverage**: Unit test verifica che response non contiene mai `session_id` raw
- ‚ö†Ô∏è **Audit Logging**: Log accessi admin a endpoint analytics per compliance tracking

**Residual Risk**:
- **Low**: Hash SHA256 unidirezionale, computazionalmente infeasible reverse engineering
- **Caveat**: Admin con accesso diretto al database pu√≤ comunque vedere session_id, ma questo √® accettabile per ruolo privilegiato

**Sources**:
- `docs/stories/4.2.analytics-dashboard.md` L237 (Risk table - R-4.2-2)
- `docs/stories/4.2.analytics-dashboard.md` L113 (Security - Anonimizzazione)
- `docs/stories/4.2.analytics-dashboard.md` L333 (Implementation - hash SHA256)
- `docs/architecture/sezione-10-sicurezza-e-performance.md` L3-6 (Security principles)

**Verification Requirements**:
- ‚úÖ Unit test: `test_analytics_session_id_anonymized()` verifica hashing
- ‚úÖ Code review: security audit checklist pre-merge
- ‚úÖ E2E test: inspect response JSON, assert no raw session_id presente
- ‚ö†Ô∏è Penetration testing: tentativo correlazione session_id hashati (Phase 2)

---

## Medium Risks Requiring Monitoring

### R-4.2-3: Performance Aggregation Lenta su Dataset Ampio

**Category**: Performance / Scalability  
**Probability**: Media (2/3)  
**Impact**: Medio (2/3)  
**Risk Score**: 4/9  
**Priority**: Medium

**Description**:
Le aggregazioni analytics (`Counter`, `percentile`, iterazione nested su `chat_messages_store`) hanno complessit√† computazionale che cresce con dimensione dataset. Con 1000+ messaggi e 100+ sessioni, aggregation latency potrebbe superare target 500ms (p95).

**Performance Projection**:
| Dataset Size | Estimated Latency | Status |
|--------------|-------------------|--------|
| 100 messages | ~50ms | ‚úÖ GOOD |
| 500 messages | ~150ms | ‚úÖ ACCEPTABLE |
| 1000 messages | ~350ms | ‚ö†Ô∏è NEAR THRESHOLD |
| 5000 messages | ~1200ms | ‚ùå UNACCEPTABLE |

**Bottlenecks Identified**:
1. **Query normalization**: Loop `strip().lower()` su tutti messaggi (O(n))
2. **Counter sorting**: `most_common(10)` su dict potenzialmente grande (O(n log n))
3. **Percentile calculation**: Sort su `ag_latency_samples_ms` array (O(n log n))
4. **Nested iteration**: Feedback aggregation loop su store completo

**Mitigation Strategy**:
- ‚úÖ **Rate Limiting**: `@limiter.limit("30/hour")` previene burst abuse
- ‚ö†Ô∏è **Caching Opzionale**: TTL 60s per aggregations (reduce complessit√† per refresh rapidi)
  ```python
  from cachetools import TTLCache
  
  analytics_cache = TTLCache(maxsize=1, ttl=60)
  
  @router.get("/api/v1/admin/analytics")
  async def get_analytics():
      cache_key = "analytics_data"
      if cache_key in analytics_cache:
          return analytics_cache[cache_key]
      
      data = _compute_analytics()
      analytics_cache[cache_key] = data
      return data
  ```
- üìä **Benchmarking**: Unit test performance verifica aggregation < 500ms con 1000 msg mock
- üîÑ **Phase 2 Optimization**: Aggregazioni pre-computate in Supabase (`materialized views`)

**Monitoring Requirements**:
- ‚ö†Ô∏è **Metric**: Log `aggregation_latency_ms` su ogni richiesta analytics
- ‚ö†Ô∏è **Alert**: Warning se p95 > 500ms, Critical se p95 > 1000ms
- üìà **Dashboard**: Grafana chart per monitorare trend latency aggregations

**Sources**:
- `docs/stories/4.2.analytics-dashboard.md` L238 (Risk table - R-4.2-3)
- `docs/stories/4.2.analytics-dashboard.md` L84-108 (Aggregation logic)
- `docs/stories/4.2.analytics-dashboard.md` L256 (Performance test < 500ms)
- `docs/architecture/sezione-10-sicurezza-e-performance.md` L25-28 (Performance targets)

**Verification Requirements**:
- ‚úÖ Unit test: `test_aggregation_performance_1000_messages()` con benchmark
- ‚ö†Ô∏è Load testing: JMeter/Locust con 100 concurrent admin analytics requests
- ‚ö†Ô∏è Production monitoring: APM tool (Sentry/DataDog) track latency p95/p99

---

### R-4.2-5: Dashboard Layout Regression su Mobile

**Category**: UX / Responsive Design  
**Probability**: Bassa (1/3)  
**Impact**: Medio (2/3)  
**Risk Score**: 2/9  
**Priority**: Medium

**Description**:
La dashboard analytics ha layout complesso (4 KPI cards, tabella, 2 chart) che deve adattarsi a breakpoint mobile (375px). Rischio regression layout:
- Tabella top queries overflow horizontal su mobile
- Chart Recharts non responsive correttamente
- Card grid non collassa a 1 colonna su viewport stretti

**Impact Analysis**:
- ‚ö†Ô∏è **UX Mobile**: Admin su tablet/phone non pu√≤ usare dashboard efficacemente
- ‚ö†Ô∏è **Accessibility**: Scrolling orizzontale degrada esperienza utente
- ‚ö†Ô∏è **Consistency**: Regressione rispetto a pattern responsive Story 4.1.5

**Mitigation Strategy**:
- ‚úÖ **Responsive Pattern Consolidato**: Layout gi√† testato in Story 4.1.5 (`grid gap-4 md:grid-cols-4`)
- ‚úÖ **Recharts ResponsiveContainer**: Component nativo per gestire width dinamica
  ```tsx
  <ResponsiveContainer width="100%" height={300}>
    <BarChart data={feedbackData}>
      {/* Chart content */}
    </BarChart>
  </ResponsiveContainer>
  ```
- ‚úÖ **Table Responsive**: Tailwind `overflow-x-auto` wrapper per tabella
  ```tsx
  <div className="overflow-x-auto">
    <table className="min-w-full">
      {/* Table content */}
    </table>
  </div>
  ```
- ‚úÖ **E2E Test Viewports**: Playwright test espliciti per 375px, 768px, 1280px

**Test Coverage**:
- ‚úÖ **E2E Scenario 8**: "Responsive mobile (375px) ‚Üí layout 1 colonna"
- ‚úÖ **E2E Scenario 9**: "Responsive desktop (1280px) ‚Üí layout 2 colonne"
- ‚ö†Ô∏è **Manual QA**: Visual regression test su device reali (iPhone SE, iPad)

**Sources**:
- `docs/stories/4.2.analytics-dashboard.md` L240 (Risk table - R-4.2-5)
- `docs/stories/4.2.analytics-dashboard.md` L34 (AC 8 - UI responsive)
- `docs/stories/4.2.analytics-dashboard.md` L292-293 (E2E test 8-9)
- `docs/architecture/addendum-recharts-implementation-4.2.md` L180-205 (Responsive patterns)

**Verification Requirements**:
- ‚úÖ E2E test PASS: viewport 375px, 768px, 1280px
- ‚ö†Ô∏è Visual regression: Percy/Chromatic screenshot diff
- ‚ö†Ô∏è Manual QA: test su Safari iOS, Chrome Android

---

## Low Risks (Resolved/Monitored)

### R-4.2-4: Chart Library Dependency Bundle Size

**Category**: Performance / Bundle Optimization  
**Probability**: Bassa (1/3)  
**Impact**: Basso (1/3)  
**Risk Score**: 1/9  
**Priority**: Low

**Description**:
Aggiunta libreria Recharts potrebbe incrementare bundle size JavaScript, impattando performance First Load e Time to Interactive.

**Mitigation Strategy** (RESOLVED):
- ‚úÖ **Recharts Adottato**: Bundle size ~95KB gzipped, accettabile per feature analytics
- ‚úÖ **Lazy Loading**: Route `/admin/analytics` lazy-loaded con `React.lazy()`
  ```typescript
  const AnalyticsPage = lazy(() => import('./pages/AnalyticsPage'));
  ```
- ‚úÖ **Tree Shaking**: Import selettivi componenti Recharts
  ```typescript
  import { BarChart, Bar, XAxis } from 'recharts'; // ‚úÖ Good
  // NOT: import * as Recharts from 'recharts'; // ‚ùå Bad
  ```
- ‚ö†Ô∏è **Monitoring**: Bundle analyzer post-implementation per verificare size effettivo

**Baseline Metrics** (from Story 4.1.5):
- Bundle pre-Recharts: 130.85KB gzip
- Bundle target post-Recharts: < 135KB gzip (+4KB acceptable)
- Lazy load analytics route: +0KB su initial load

**Sources**:
- `docs/stories/4.2.analytics-dashboard.md` L239 (Risk table - R-4.2-4, status RISOLTO)
- `docs/stories/4.2.analytics-dashboard.md` L214 (Bundle size ~95KB)
- `docs/architecture/addendum-recharts-implementation-4.2.md` L221-238 (Performance optimization)
- `docs/qa/assessments/4.1.5-nfr-assessment-20251002.md` L42-44 (Baseline bundle size)

**Verification Requirements**:
- ‚ö†Ô∏è `pnpm build` post-implementation ‚Üí bundle analyzer report
- ‚ö†Ô∏è Lighthouse score: verifica nessuna regressione performance
- ‚úÖ Lazy loading: verifica `/admin/analytics` chunk separato in build output

---

## Detailed Risk Register

| Risk ID | Description | Category | Probability | Impact | Score | Priority | Mitigation Status | Sources |
|---------|-------------|----------|-------------|--------|-------|----------|-------------------|---------|
| R-4.2-1 | Dati in-memory volatili (no persistence) | Tech Debt | Alta (3) | Alto (3) | 9 | High | **ACCEPTED** - Phase 2 Supabase persistence | Story L236, PRD L68-73 |
| R-4.2-2 | Privacy leak session_id senza hashing | Security | Bassa (1) | Alto (3) | 3 | High | **MITIGATED** - SHA256 hash mandatory | Story L237, L333, Arch L3-6 |
| R-4.2-3 | Performance aggregation lenta | Performance | Media (2) | Medio (2) | 4 | Medium | **MITIGATED** - Rate limit + cache opzionale | Story L238, L84-108, L256 |
| R-4.2-4 | Bundle size increase Recharts | Performance | Bassa (1) | Basso (1) | 1 | Low | **RESOLVED** - Lazy load + tree shaking | Story L239, L214, Addendum L221-238 |
| R-4.2-5 | Layout regression mobile | UX | Bassa (1) | Medio (2) | 2 | Medium | **MITIGATED** - E2E test + responsive pattern | Story L240, L292-293, Addendum L180-205 |

**Risk Scoring Legend**:
- Probability: Low (1), Medium (2), High (3)
- Impact: Low (1), Medium (2), High (3), Critical (4)
- Score: Probability √ó Impact
- Priority: Critical (‚â•9), High (6-8), Medium (3-5), Low (1-2)

---

## Risk-Based Testing Strategy

### High Priority Testing (Mandatory)

**R-4.2-2: Privacy/Security Testing**
- ‚úÖ **Unit Test**: `test_analytics_anonymizes_session_id()`
  - Input: analytics data con session_id `"abc123"`
  - Expected: response contiene hash SHA256 troncato, no `"abc123"` presente
- ‚úÖ **Integration Test**: E2E call `/api/v1/admin/analytics`
  - Assert: inspect JSON response, regex search `session_id`, no match raw format
- ‚ö†Ô∏è **Security Audit**: Code review checklist item "Session ID hashing implemented"

**R-4.2-1: Technical Debt Acceptance**
- ‚úÖ **Documentation**: Verificare Change Log traccia decisione debito tecnico
- ‚úÖ **Backlog**: Ticket Phase 2 creato con acceptance criteria persistence Supabase
- ‚ö†Ô∏è **User Acceptance**: Admin training comunicare limitazione dati volatili

---

### Medium Priority Testing (Recommended)

**R-4.2-3: Performance Testing**
- ‚úÖ **Unit Test**: `test_aggregation_performance_1000_messages()` con benchmark < 500ms
- ‚ö†Ô∏è **Load Test**: JMeter scenario 50 concurrent admin analytics requests
  - Target: p95 < 500ms, p99 < 1000ms
  - Duration: 5 minutes sustained load
- ‚ö†Ô∏è **Monitoring**: Setup APM alerts per aggregation latency

**R-4.2-5: Responsive Testing**
- ‚úÖ **E2E Test**: Playwright scenario 8 (mobile 375px) e 9 (desktop 1280px)
- ‚ö†Ô∏è **Visual Regression**: Screenshot diff pre/post implementation
- ‚ö†Ô∏è **Manual QA**: Test su Safari iOS, Chrome Android con device reali

---

### Low Priority Testing (Optional)

**R-4.2-4: Bundle Size Monitoring**
- ‚ö†Ô∏è **Bundle Analyzer**: `pnpm build --analyze` post-implementation
- ‚ö†Ô∏è **Lighthouse CI**: Performance score regression check
- ‚ö†Ô∏è **Lazy Load Verification**: Chrome DevTools Network tab, verify analytics chunk separate

---

## Monitoring Requirements

### Application Performance Monitoring (APM)

**Metrics da Tracciare**:
1. **Aggregation Latency**: `analytics_aggregation_duration_ms`
   - Alert: Warning se p95 > 500ms, Critical se p95 > 1000ms
   - Histogram: Grafana dashboard con trend latency nel tempo

2. **Analytics API Calls**: `analytics_endpoint_requests_total`
   - Counter: Totale richieste per admin user
   - Alert: Spike anomalo (>100 req/hour per singolo admin)

3. **Session ID Anonymization**: `analytics_session_anonymized_total`
   - Counter: Verificare 100% session_id processati con hashing
   - Alert: Se counter < 100% richieste ‚Üí bug potenziale

4. **Cache Hit Rate** (se implementato cache opzionale):
   - Metric: `analytics_cache_hit_rate`
   - Target: >80% hit rate per reduce aggregation load

---

### Security Monitoring

**Audit Logging**:
- ‚úÖ Log ogni accesso admin a `/api/v1/admin/analytics`
  - Fields: `admin_user_id`, `timestamp`, `request_ip`, `response_status`
- ‚ö†Ô∏è Alert: Multiple failed 403 attempts (possibile attacco privilege escalation)

**Privacy Compliance**:
- ‚úÖ Quarterly audit: Review analytics response samples, verify no PII leak
- ‚ö†Ô∏è GDPR compliance check: Session ID hashing effective, no reverse engineering possible

---

### User Experience Monitoring

**Admin Feedback**:
- ‚ö†Ô∏è Survey: Post-implementation, chiedere admin utilit√† dashboard con dati volatili
- üìä Success Metric: ‚â•70% admin sessions visitano analytics almeno 1x/settimana

**Error Tracking**:
- ‚ö†Ô∏è Sentry: Capture frontend errors su `AnalyticsPage.tsx`
  - Recharts rendering errors
  - API fetch failures
  - Responsive layout issues mobile

---

## Residual Risks (Post-Mitigation)

### Accepted Risks

**R-4.2-1: Dati Volatili (Technical Debt)**
- **Residual Impact**: Analytics limitato a sessione server corrente
- **Acceptance Rationale**: Trade-off velocit√† implementazione (MVP 5-7h) vs completezza funzionale
- **Mitigation Path**: Phase 2 persistence Supabase (Q1 2026)
- **Monitoring**: Feedback admin su utilit√† dashboard volatile

---

### Risks Requiring Ongoing Monitoring

**R-4.2-3: Performance Scalability**
- **Residual Risk**: Aggregation latency cresce con dataset size
- **Threshold**: Acceptable fino a ~1000 messaggi, degradazione oltre
- **Monitoring**: APM alert se p95 > 500ms
- **Mitigation Future**: Materialized views Supabase (Phase 2)

**R-4.2-5: Mobile UX**
- **Residual Risk**: Edge cases responsive non coperti da test automatizzati
- **Monitoring**: User feedback mobile/tablet admin
- **Mitigation**: Manual QA su device reali pre-release

---

## Gate Decision Criteria

### Pre-Implementation Gate (Story Start)

**PASS Criteria**:
- ‚úÖ R-4.2-1 technical debt acceptance formalized in Change Log
- ‚úÖ R-4.2-2 mitigation strategy (SHA256 hashing) agreed by Tech Lead
- ‚úÖ R-4.2-3 performance benchmark test cases defined
- ‚úÖ Recharts installation command documented

**Status**: ‚úÖ **GATE PASSED** (2025-10-02)

---

### Pre-Merge Gate (Code Review)

**PASS Criteria**:
- ‚úÖ Unit tests PASS: ‚â•85% coverage backend, ‚â•90% frontend
- ‚úÖ Security audit checklist: Session ID hashing verified
- ‚úÖ E2E tests PASS: All 10 scenarios (navigation, responsive, security)
- ‚ö†Ô∏è Performance benchmark: Aggregation < 500ms with 1000 messages
- ‚ö†Ô∏è Bundle size analysis: Recharts impact < +5KB gzip

**Status**: ‚è≥ **PENDING IMPLEMENTATION**

---

### Pre-Production Gate (Release)

**PASS Criteria**:
- ‚úÖ Zero critical/high severity bugs open
- ‚ö†Ô∏è APM monitoring configured: aggregation latency, API calls
- ‚ö†Ô∏è Admin training: Comunicato limitazione dati volatili
- ‚ö†Ô∏è Lighthouse score: No regression vs baseline (‚â•90)
- ‚úÖ Phase 2 backlog ticket created: Supabase persistence

**Status**: ‚è≥ **PENDING IMPLEMENTATION**

---

## Recommendations

### Immediate Actions (Pre-Implementation)

1. **Security Review Mandatory**:
   - Code review checklist: Verificare SHA256 hashing session_id implementato correttamente
   - Peer review: Security specialist approve R-4.2-2 mitigation

2. **Performance Baseline**:
   - Eseguire spike test: Aggregation timing con 500, 1000, 2000 messaggi mock
   - Definire threshold alert APM basato su risultati spike

3. **Technical Debt Tracking**:
   - Creare ticket Backlog Phase 2: "Story 4.2.1 - Persist Analytics Data to Supabase"
   - Acceptance criteria: 90 giorni retention, materialized views, batch insert

---

### Post-Implementation Actions

1. **Monitoring Setup** (Week 1):
   - Configure APM: Aggregation latency, cache hit rate, API calls
   - Setup Sentry error tracking per `AnalyticsPage.tsx`
   - Grafana dashboard: Analytics performance metrics

2. **User Validation** (Week 2-4):
   - Admin feedback survey: Utilit√† dashboard con dati volatili
   - Collect pain points: Identificare requirement critici per Phase 2
   - Success metric tracking: % admin sessions visitano analytics

3. **Phase 2 Planning** (Month 2):
   - Architecture design: Supabase schema `analytics_events` table
   - Performance modeling: Batch insert frequency vs data freshness
   - Migration strategy: Backfill storico (se possibile) vs fresh start

---

## Change Log

| Date | Author | Change Description |
|------|--------|-------------------|
| 2025-10-02 | QA Team | Initial risk assessment - 5 risks identified, 2 High priority |
| 2025-10-02 | QA Team | R-4.2-1 classified as ACCEPTED technical debt per Tech Lead decision |
| 2025-10-02 | QA Team | R-4.2-4 status updated to RESOLVED following Recharts adoption |

---

## Appendix: Risk Scoring Methodology

**Probability Scale**:
- Low (1): < 30% likelihood
- Medium (2): 30-60% likelihood
- High (3): > 60% likelihood

**Impact Scale**:
- Low (1): Minor inconvenience, quick fix
- Medium (2): Feature degradation, workaround possible
- High (3): Feature unusable, no workaround
- Critical (4): System down, data loss, security breach

**Priority Calculation**:
- Score = Probability √ó Impact
- Priority: Critical (‚â•9), High (6-8), Medium (3-5), Low (1-2)

---

## Sources & References

### Primary Sources
- **Story Document**: `docs/stories/4.2.analytics-dashboard.md` (L1-L508)
- **PRD Epic 4**: `docs/prd/sezione-epic-4-dettagli-post-mvp-enhancements.md` (L48-L76)
- **Architecture Security**: `docs/architecture/sezione-10-sicurezza-e-performance.md`
- **Testing Strategy**: `docs/architecture/sezione-11-strategia-di-testing.md`
- **Recharts Implementation**: `docs/architecture/addendum-recharts-implementation-4.2.md`

### Related Assessments
- **Story 4.1.5 NFR**: `docs/qa/assessments/4.1.5-nfr-assessment-20251002.md` (bundle baseline)
- **Story 4.1 Risk**: `docs/qa/assessments/4.1-risk-20251001.md` (admin auth patterns)

---

**Assessment Complete**: 2025-10-02  
**Next Review**: Post-Implementation (TBD)  
**QA Approval**: ‚úÖ APPROVED WITH CONDITIONS  
**Tech Lead Approval**: ‚è≥ PENDING REVIEW

