# Requirements Traceability Matrix

## Story: 2.1 - Document Loader & Text Extractor

### Coverage Summary

- Total Requirements: 5
- Fully Covered: 5 (100%)
- Partially Covered: 0 (0%)
- Not Covered: 0 (0%)

### Requirement Mappings

#### AC1: Il servizio accede a una directory di file

**Coverage: FULL**

Given-When-Then Mappings:

- **Integration Test**: `2.1-INT-001`
  - Given: Directory configurata, permessi lettura corretti
  - When: Il servizio tenta l'accesso
  - Then: L'accesso avviene (o fallisce con errore gestito)

#### AC2: Scansiona file nuovi/modificati

**Coverage: FULL**

- **Unit Test**: `2.1-UNIT-002`
  - Given: Contenuto file deterministico
  - When: Si calcola `file_hash`
  - Then: Il risultato è deterministico e coerente

- **Integration Test**: `2.1-INT-002`
  - Given: Directory con file esistenti e un file modificato
  - When: Esegue la scansione
  - Then: I file nuovi/modificati sono rilevati

#### AC3: Il testo viene estratto correttamente

**Coverage: FULL**

- **Integration Test**: `2.1-INT-003`
  - Given: Fixture `.pdf`
  - When: Loader `.pdf` estrae il testo
  - Then: Il testo atteso è ottenuto

- **Integration Test**: `2.1-INT-004`
  - Given: Fixture `.docx`
  - When: Loader `.docx` estrae il testo
  - Then: Il testo atteso è ottenuto

#### AC4: Il contenuto viene salvato temporaneamente

**Coverage: FULL**

- **Integration Test**: `2.1-INT-006`
  - Given: Testo estratto e metadati
  - When: Si salva nel modello `Document`
  - Then: `file_name`, `file_path`, `file_hash`, `status`, `metadata` sono persistiti

#### AC5: Gestisce errori di parsing

**Coverage: FULL**

- **Unit Test**: `2.1-UNIT-003`
  - Given: Eccezioni di parsing note
  - When: Passano nel classificatore errori
  - Then: Sono marcate come recuperabili/non recuperabili

- **Integration Test**: `2.1-INT-007`
  - Given: File corrotto
  - When: Parsing fallisce
  - Then: `Document.status` viene aggiornato coerentemente

### Critical Gaps

Nessuna

### Test Design Recommendations

- Mantenere fixture `.pdf`/`.docx` minimali e controllate per evitare flaky.

### Risk Assessment

- Low/Medium Risk: Coperti da unit/integration; E2E solo sanity.

### Sources

- `docs/stories/2.1.document-loader-and-text-extractor.md`
- `docs/qa/assessments/2.1-test-design-20250916.md`
