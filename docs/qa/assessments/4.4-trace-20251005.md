# Traceability – Story 4.4: Document Chunk Explorer

Data: 2025-10-05
Fonte primaria: `docs/stories/4.4-document-chunk-explorer.md`

## Requisiti (Acceptance Criteria)
1. Document List View `/admin/documents` con colonne richieste. [fonte: L52-L53]
2. Navigazione a `/admin/documents/{document_id}/chunks`. [fonte: L54-L55]
3. Chunk Display con preview, ID, size, metadata, embedding status. [fonte: L56-L62]
4. Chunk Expansion via dialog/accordion. [fonte: L63-L64]
5. Filtri: strategia e range dimensione. [fonte: L65-L68]
6. Sorting: sequence (default), size, creation date. [fonte: L69-L73]
7. Empty State quando nessun chunk. [fonte: L74-L75]
8. Responsive design. [fonte: L76-L77]
9. Performance: < 500ms per 200 chunk. [fonte: L78-L79]
10. Access Control: solo admin autenticati. [fonte: L80-L81]

## Implementazione – Riferimenti
- Schema `document_chunks` con campi e JSONB metadata. [fonte: L88-L110]
- Pattern database `asyncpg` con pooling e query parametrizzate. [fonte: L114-L121]
- Endpoint `GET /api/v1/admin/documents` con MODE() e aggregazioni. [fonte: L134-L189]
- Endpoint `GET /api/v1/admin/documents/{document_id}/chunks` con filtri/sort/paginazione. [fonte: L202-L320]
- UI `DocumentsPage.tsx` struttura tabella e link navigazione. [fonte: L365-L413]
- UI `DocumentChunksPage.tsx` struttura lista, filtri Select, Dialog contenuto completo. [fonte: L416-L519]
- Accesso admin con `AdminGuard`. [fonte: L80-L81]
- Pagine e file di destinazione. [fonte: L717-L726]

## Test – Riferimenti
- Backend Unit Tests (6 casi). [fonte: L589-L598]
- Frontend Unit Tests (8 casi). [fonte: L605-L616]
- E2E Tests (6 scenari). [fonte: L623-L631]
- Risultati test: backend 6/6, frontend 8/8, e2e 6/6. [fonte: L801-L804]

## Dipendenze/Prerequisiti – Riferimenti
- Prerequisiti backend e frontend completati. [fonte: L540-L559]
- Fasi di implementazione e checklist con stato. [fonte: L646-L666, L676-L696, L705-L714]
- Tasks/Subtasks completati. [fonte: L729-L761]

## Matrice di Tracciabilità

| ID Req | Descrizione sintetica | Implementazione | Test |
|---|---|---|---|
| AC-1 | Document List View `/admin/documents` | Endpoint lista documenti [L134-L189]; UI `DocumentsPage.tsx` [L365-L413] | FE unit test rendering tabella [L607-L615]; E2E scenario 1 [L625-L627] |
| AC-2 | Navigazione a chunks view | UI link a `/admin/documents/{id}/chunks` [L401-L406]; Route `DocumentChunksPage.tsx` [L418-L419] | FE unit test navigazione [L608-L610]; E2E scenario 2 [L627-L628] |
| AC-3 | Chunk display con preview/metadata/status | Endpoint chunks con campi richiesti [L272-L283]; UI card contenuto/metadata/badge [L477-L493, L495-L501] | FE unit tests badge e rendering [L613-L616]; E2E scenario 2 [L627-L628] |
| AC-4 | Espansione contenuto completo | UI Dialog full content [L501-L513] | E2E scenario 3 [L628-L629] |
| AC-5 | Filtri | Endpoint param `strategy`, `min_size` [L245-L255, L290-L300]; UI Select filtro strategia [L449-L461] | FE unit test filter [L615-L616]; E2E scenario 4 [L629-L630] |
| AC-6 | Sorting | Endpoint `sort_by` [L206-L208, L302-L305]; UI Select sort [L463-L473] | FE unit test sort [L614-L615]; E2E scenario 5 [L630-L631] |
| AC-7 | Empty state | DocumentsPage: tabella e stati (descritti) [L369-L413] | FE unit test empty state [L610-L612] |
| AC-8 | Responsive | Richiesta responsive [L76-L77]; UI con layout Tailwind [L441-L448, L476-L517] | non disponibile nella fonte |
| AC-9 | Performance 500ms/200 chunk | Requisito performance [L78-L79] | non disponibile nella fonte |
| AC-10 | Access control admin-only | AdminGuard richiesto [L80-L81] | E2E scenario 6 [L631-L632] |

## Ulteriori Riferimenti
- Risk e mitigazioni (paginazione, rate limiting). [fonte: L575-L582]
- Metriche di successo. [fonte: L637-L643]
- Change log e stato implementativo. [fonte: L787-L806]
