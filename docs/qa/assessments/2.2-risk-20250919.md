# Risk Profile: Story 2.2

Date: 2025-09-19
Reviewer: Quinn (Test Architect)

## Executive Summary

- Total Risks Identified: 3
- Critical Risks: 0
- High Risks: 0
- Risk Score: 78/100

## Critical Risks Requiring Immediate Attention

Nessuna

## Risk Distribution

### By Category

- Technical: 2 (0 critical)
- Operational: 1 (0 critical)

### By Component

- Backend: 3

## Detailed Risk Register

| Risk ID   | Description                                                                                   | Probability | Impact     | Score | Priority |
| --------- | --------------------------------------------------------------------------------------------- | ----------- | ---------- | ----- | -------- |
| TECH-CL-1 | Assenza provider LLM configurato in runtime per la catena LCEL (`_get_llm` placeholder)      | Medium (2)  | Medium (2) | 4     | Medium   |
| TECH-CL-2 | Possibili classificazioni errate su contenuti edge-case (tabelle annidate, figure, misti)     | Low (1)     | Medium (2) | 2     | Low      |
| OPS-CL-1  | Mancato collegamento audit → `Document.metadata`/`chunking_strategy` nella fase successiva    | Low (1)     | Medium (2) | 2     | Low      |

### Mitigations

- TECH-CL-1
  - Strategy: preventive
  - Actions:
    - Introdurre provider LLM configurabile via env (es. `langchain-openai`), separando init da runtime
    - Aggiungere dependency injection per testing/integration
  - Testing requirements:
    - Mock end-to-end della catena con e senza provider reale
  - Residual risk: Low
  - Owner: dev
  - Timeline: prima del deploy

- TECH-CL-2
  - Strategy: detective
  - Actions:
    - Aggiungere test su casi limite (documenti con molte tabelle/figure, PDF scansionati)
  - Testing requirements:
    - Test parametrizzati su input edge-case e verifica confidenza
  - Residual risk: Low
  - Owner: dev
  - Timeline: prima del merge

- OPS-CL-1
  - Strategy: preventive
  - Actions:
    - Integrare salvataggio della `classificazione` e `confidenza` in `Document.metadata` e `chunking_strategy`
  - Testing requirements:
    - Test di integrazione nella pipeline di ingestion (story 2.3)
  - Residual risk: Low
  - Owner: dev
  - Timeline: prima dell'integrazione 2.3

## Risk-Based Testing Strategy

### Priority 2: Medium
- Validazione dependency injection e fallback LLM

### Priority 3: Low
- Scenari edge-case di classificazione; verifica audit trail

## Monitoring Requirements

- Log strutturati per esiti di classificazione; dashboard di errori/percentuali per categoria

## Sources

- `docs/stories/2.2.structural-analysis-meta-agent.md` (AC1–AC5, Dev Notes, QA Results)
- `apps/api/api/main.py` (endpoint `/classify`, chain builder, logging)

