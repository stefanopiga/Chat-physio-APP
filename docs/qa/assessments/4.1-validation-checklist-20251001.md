# Story 4.1 - Validation Checklist

**Data**: 2025-10-01  
**Owner**: QA Lead + Tech Lead  
**Deadline**: 2025-10-02  

---

## Pre-Decisione: Validazione Tecnica

### Test E2E - Pattern Post-Load Injection

- [ ] **Eseguire suite completa E2E**
  ```bash
  cd apps/web && pnpm test:e2e story-4.1.spec.ts
  ```
  - [ ] Test 1: Admin autenticato → Debug RAG visibile ✅
  - [ ] Test 2: Utente non autenticato → Redirect a `/` ✅
  - [ ] Test 3: Student (non admin) → Redirect a `/` ✅

- [ ] **Stability Test (10 run consecutivi)**
  ```bash
  for i in {1..10}; do pnpm test:e2e story-4.1.spec.ts; done
  ```
  - [ ] Success rate: ___/10 (target: 10/10)
  - [ ] Flaky test identificati: ___
  - [ ] Tempo medio esecuzione: ___ secondi

- [ ] **Performance Baseline**
  - [ ] Tempo esecuzione con doppia navigazione: ___ secondi
  - [ ] Confronto con test senza doppia nav (stima): ___ secondi
  - [ ] Overhead accettabile? (target: < +5s per test) [ ] Sì [ ] No

### Cross-Browser Validation

- [ ] **Chromium** (default Playwright)
  ```bash
  pnpm test:e2e story-4.1.spec.ts --project=chromium
  ```
  - [ ] Test passing
  - [ ] Timing stabile

- [ ] **Firefox** (opzionale)
  ```bash
  pnpm test:e2e story-4.1.spec.ts --project=firefox
  ```
  - [ ] Test passing
  - [ ] Timing stabile

- [ ] **Webkit/Safari** (opzionale)
  ```bash
  pnpm test:e2e story-4.1.spec.ts --project=webkit
  ```
  - [ ] Test passing
  - [ ] Timing stabile

---

## Acceptance Criteria - Story 4.1

### Funzionalità (da PRD)

- [ ] Admin può accedere a `/admin/debug`
- [ ] Form con textarea per domanda test
- [ ] Button "Esegui Query Debug" funzionante
- [ ] Response mostra:
  - [ ] Risposta finale LLM
  - [ ] Lista chunk recuperati
  - [ ] Score similarità per chunk
  - [ ] Metadati (documento, pagina, strategy)
  - [ ] Timing metrics (retrieval_ms, generation_ms)

### UI/UX

- [ ] Dark mode funzionante
- [ ] Componenti Shadcn/UI usati correttamente
- [ ] Accessibilità keyboard (tab navigation)
- [ ] Focus visibile su form controls
- [ ] Responsive design (mobile, tablet, desktop)

### Sicurezza

- [ ] Endpoint protetto da JWT admin
- [ ] Non-admin rediretto a `/`
- [ ] Non-autenticato rediretto a `/`
- [ ] No esposizione dati sensibili in response

---

## Code Quality

### Backend

- [ ] **Test Coverage**
  ```bash
  cd apps/api && poetry run pytest tests/test_admin_debug.py --cov
  ```
  - [ ] Coverage > 80% (target PRD)
  - [ ] Tutti i test passing (8/8)

- [ ] **Linting**
  ```bash
  poetry run ruff check api/
  ```
  - [ ] No errori ruff
  - [ ] No security warnings

### Frontend

- [ ] **Test Coverage**
  ```bash
  cd apps/web && pnpm test -- AdminDebugPage --coverage
  ```
  - [ ] Coverage componenti > 80% (se unit test implementati)
  - [ ] E2E passing (3/3)

- [ ] **Linting**
  ```bash
  pnpm lint
  ```
  - [ ] No errori ESLint
  - [ ] No TypeScript errors

- [ ] **Build Production**
  ```bash
  pnpm build
  ```
  - [ ] Build successful
  - [ ] No warnings critici
  - [ ] Bundle size accettabile

---

## Documentazione

### Completezza

- [ ] Story 4.1 aggiornata con note implementazione
- [ ] Addendum E2E mocking (Sezione 9) completo
- [ ] Team discussion points creato
- [ ] Executive summary creato
- [ ] Validation checklist (questo file) completo

### Accuratezza

- [ ] Code snippets testati e funzionanti
- [ ] Comandi verificati su Windows
- [ ] Path file corretti
- [ ] Riferimenti incrociati validi

---

## Decisione PO

### Opzioni Valutate

- [ ] **Opzione A**: Accettare pattern post-load injection
  - [ ] Approvata [ ] Rigettata
  - [ ] Note: _________________________________

- [ ] **Opzione B**: Refactoring auth service (post-MVP)
  - [ ] Approvata per backlog [ ] Rigettata
  - [ ] Note: _________________________________

- [ ] **Opzione C**: Skip E2E, aumentare unit test
  - [ ] Approvata [ ] Rigettata
  - [ ] Note: _________________________________

### Go-Live Decision

- [ ] **Story 4.1 pronta per deployment**
  - [ ] Sì, con Opzione A
  - [ ] Sì, con Opzione C
  - [ ] No, richiede Opzione B
  - [ ] No, altri blockers: _________________________________

---

## Action Items Post-Validazione

### Se Approvato Opzione A

- [ ] Merge PR con pattern post-load injection
- [ ] Aggiornare CI/CD con test E2E
- [ ] Training team su pattern (30min session)
- [ ] Monitoring metriche test in CI/CD
- [ ] Creare epic tech debt per Opzione B (backlog)

### Se Approvato Opzione C

- [ ] Rimuovere test E2E story-4.1.spec.ts
- [ ] Implementare unit test RTL per AdminGuard
- [ ] Implementare integration test React Router
- [ ] Aggiornare coverage report
- [ ] Documentare gap E2E accettato

### Se Richiesto Opzione B

- [ ] Design proposal auth service (2 giorni)
- [ ] Review architetturale team
- [ ] Stima effort completo
- [ ] Pianificare sprint tech debt
- [ ] Regression test plan tutte le story auth

---

## Sign-Off

| Ruolo | Nome | Data | Firma | Note |
|-------|------|------|-------|------|
| QA Lead | ___ | ___ | ___ | Validazione tecnica test |
| Tech Lead | ___ | ___ | ___ | Approvazione soluzione |
| PO | ___ | ___ | ___ | Go-live decision |
| Architect | ___ | ___ | ___ | Review architetturale (se Opzione B) |

---

## Metriche Finali (da compilare post-validazione)

- **Test E2E Success Rate**: ___% (10 run)
- **Tempo Esecuzione Suite**: ___ secondi
- **Coverage Backend**: ___%
- **Coverage Frontend**: ___%
- **Build Time**: ___ secondi
- **Bundle Size**: ___ MB

---

**Prepared by**: AI Development Team  
**Last Updated**: 2025-10-01  
**Next Review**: 2025-10-02 (post-validazione QA)

